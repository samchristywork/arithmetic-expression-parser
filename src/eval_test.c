#include <stdio.h>
#include <stdlib.h>

#include "eval.h"

#define TEST(n) test(#n, n)

int ntests = 0;
int npassed = 0;
void test(char *string, int should_equal) {
  int result;
  int ret = eval(string, &result);
  printf("%d - %s=%d=%d\n", ret, string, result, should_equal);
  ntests++;
  if (result == should_equal)
    npassed++;
}

int main() {
  TEST(1 + 1);
  TEST(1 + 1);
  TEST(1 - 1);
  TEST(5334 - 3452 * 223 - 342 / 5);
  TEST(5 - 3 * 2 - 3 / 5);
  TEST((1));
  TEST((1 + 1) * 2);
  TEST((1 + 1) * (5 * 5) / 4);

  TEST(2 + 0 - (6) * 1 * 5 + 5 * 4 + (7 / 6 - (5)));
  TEST(2 + 0 - (6) * 1 * 5 + 5 * 4 + (7 / 6 - (5)) - 6 * 9 * 3 / 7 - 4 - 5 - 2 -
       5 / 4 * 7 - (4) * 4 / 3 / 1 - 7 / (8) * (6) * (8 * 8) + 4 / 3 * (1) + 4 +
       9 + 2 + 0 * (6 / 8 * 9 - 2) - 6 - 6 / 4 + 9 / 5 - 0 * 4 / 8);
  TEST(862 + 170 - (996) * 281 * 305 + 925 * 84 + (327 / 336 - (505)) -
       846 * 729 * 313 / 857 - 124 - 895 - 582 - 545 / 814 * 367 -
       (434) * 364 / 43 / 750 - 87 / (808) * (276) * (178 * 788) +
       584 / 403 * (651) + 754 + 399 + 932 + 60 * (676 / 368 * 739 - 12) - 226 -
       586 / 94 + 539 / 795 - 570 * 434 / 378);

  test("(1+1+1)^2", 9);
  test("2^3", 8);

  TEST((1 + (1)));
  TEST((1 + (1) + 1) + 1);

  // TEST((170)-(318)+341+148/82+130+((376)*343/37)-201*22+288-3*322*6-199*342-127*103-323*101*275*174+90-357+222-120+39+247/(365-279)*(34-301*271+215)*(33)-(18)*(241)+377+88-(59)-49-27/(63*21)+33*295/363-193-15-336*327+324-((161))-35*331+33*188*20-313*204*300*348/155+188-213/((188+239))-72-215*328/164/((264))*((355))-227/285/38-173+((298*231+(188)))*((285/175*(162))*63+243/110/129*82/164-60+286)*81+58/(91)/302-271/279/158+((376/112))/136+158/26-108+35-312-179-208*(260+27)+((14))/(162/236*(209)/258/129+320-5/211+101-98/147-215+156/(238)-((134))-(44)*(168)*325*71-313-79+229/339-220-264));
  TEST((160 * 21 + 135 - 43 - 51 - 101 * 100 / 15));
  TEST(592 * 179 + 286 + 610 * (328) / 750 / 429);
  // TEST((58/66)+56*33-45-38+68+77*18*36+69-75/65+57+(69/54/21*80+((3)))+65-54*6+82*(40)/29-74-(8+21/(26))*((20/58/40*42))*30+30-4/68/54-37/42*46-(23)/34*27+(36)/59/37/(13)/55*80-34/66/43/32*62+72/63-26*49*45/2/23+((41)+44-9)+(27+4)/(34)*(82)/(82*76-44+21-66*28/(13))*((((41))))/((21)+(67)-53+18-(17))*((75/61/50+53))+(5*69*79+55)/(30/81)*34-27+(81)+(((0)/55*2*34/53/0*66-53+61/49/81-(30)*(46))));
  // TEST(((96+678+174/299*397+126-334-594/555-83*40-299*(160*306)*638-162-(24)+305-66*(146)*500/466-321+41*120/322-634-276/(119+261-301*215-241*5*(515)-168*131+379+64*(687-462)))));
  TEST((((29 / 537 + 434 * 264) * 95 - 415 * 71 / 139 + 92 + 133 - 312 + 540) /
            405 / 268 / 198 +
        242 * (137) / 285 - 192 + (249 - 183 / 140 / 490) * 31 +
        249 / (2) * 350 / 7 + (107) / 444 - 451 - 39 + 341 - 244 + 205 +
        338 / 116));
  TEST(((404) * 154 * 243) / (248 + 786 * 690 * 128));
  TEST(16 + 102 - (47) * 42 / 37 - (80) / ((151 / 55)) / 83 - 140 / 11 - 7 +
       12 / 102 - 10 + 38 / 73 * 18 / 42 - 129 -
       (54) / (32) * (119 - 157 / 33 + 119 * 62 - 134 * (47)) - ((132)) +
       (140) / 64 + 75 * 28 / 106 - (112) * 108 / 24 * 94 - 117);
  TEST(101 / 44 +
       144 / 108 / 165 / 87 * 163 / 108 * (53 * 27 / 22 + 123) / 69 * 25 /
           (140) -
       163 + 19 * 172 + 113 - 160 + 168 / 137 * 56 - 28 / 139 + 66 * 108 +
       152 * 26 * 117 * 165 + 127 - 64 * 30 / 138 - (48) * (20) * (120) - 58 -
       156 - ((49)) + 80 + 0 - 20 * 105 / (42) - 85 -
       124 / (34 * 17) *
           (((5 * 21 + 57 - 62) + 49 - 15 / 30 * 59 + (69 + 56))) +
       78 * 136 / 85 * 142 + (167) / 42 * 92 * (6) + 64 / 150 - 64 + 16 / 132 -
       65 * 36 - 57 * (107) + 24 + 83 + 141 / 124 - 89 - 64 -
       0 * 53 / (113 * 98) *
           (83 * 74 * (168) / 41 / 153 - 123 - 28 + 16 + 11 * 71 * 11 * 100 -
            37 * 63 + 165) /
           (53 - 15) / 49 +
       173 * 155 * 58 - 16 + 57 - 19 - 42 * (48) * 83 * 43 * 101 -
       99 * 43 / 86 - 173 - 113 - 29 * 145 + 56 + 58 + 64 - 150 +
       31 / 75 / 70 * 68 * (138) / (54) + (122 * 153) + (5) + (114) / 127 + 63 -
       (32) * 87 - 165 + 74 * 135 + 68 / 19 - (139) + 69 - 63 / 127 + 61 +
       (78 - 157));
  // TEST((((6)*24-24*(23*17))*(23)+14/27*(2-11)+27*29/5-26/(8*19)-(15+5)/(2/11)-((5)+19-29)+11/26+2/11*10*25*23+2-(1+9/27*16))*((((18*12))-((0)+16-14)-(((3)*13-6))))/((((9/10*14-28)/25/11*(22)/29-17*3-28+(20*29)/22*23+1*18*(17)+4-11/26+23+28+15))));

  test("1/0", 0);
  test("(", 0);
  test(")", 0);
  test("*", 0);
  test("/", 0);
  test("+", 0);
  test("-", 0);
  test("*/+-", 0);

  printf("DONE %d tests passed out of %d\n", npassed, ntests);
}
